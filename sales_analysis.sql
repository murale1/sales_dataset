-- 1. What are the details of all cars purchased in the year 2022?

select cars.* from sales join cars using (car_id) where year(purchase_date)='2022'

-- 2.What is the total number of cars sold by each salesperson?

select name, count(sale_id) as cars_sold
from sales  join salespersons using(salesman_id)
group by name

-- 3. What is the total revenue generated by each salesperson?
  
select name  , sum(cost_$) as total_revenue
from sales 
join salespersons using(salesman_id) 
join cars c using(car_id)
group by salesman_id
  
-- 4.What are the details of the cars sold by each salesperson?
  
select salesman_id,name,cars.*
from sales
join salespersons using(salesman_id) 
join cars using(car_id)

-- 5.What is the total revenue generated by each car type?
  
select type,sum(cost_$) as revenue
from sales  
join salespersons using(salesman_id) 
join cars using(car_id)
group by type


-- 6.What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
  
select *
from cars 
where car_id in (select car_id
from sales 
join salespersons using(salesman_id)
where name='Emily Wong' and year(purchase_date)='2021')
  
-- 7. What is the total revenue generated by the sales of hatchback cars?
  
select style,sum(cost_$) as total_revenue
from cars 
join sales 
using(car_id)
where style='Hatchback'
  
-- 8.What is the total revenue generated by the sales of SUV cars in the year 2022?
  
select style,sum(cost_$)
from cars 
join sales 
using(car_id)
where style='SUV' and year(purchase_date)='2022'
  
-- 9.What is the name and city of the salesperson who sold the most number of cars in the year 2023?
  
select name,city
from sales 
join salespersons  using(salesman_id)
where year(purchase_date)='2023'
group by salesman_id
limit 1
  
-- 10.What is the name and age of the salesperson who generated the highest revenue in the year 2022?
  
select name,city, sum(cost_$) as total_revenue
from sales 
join salespersons using(salesman_id)
join cars using(car_id)
where year(purchase_date)='2022'
group by salesman_id
order by total_revenue desc
limit 1
